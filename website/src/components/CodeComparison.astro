---
interface Props {
  leftFile?: string;
  leftTag?: string;
  rightFile?: string;
  rightTag?: string;
}

const {
  leftFile = 'spec.yaml',
  leftTag = 'you write this',
  rightFile = 'generated/src/server.ts',
  rightTag = 'generated'
} = Astro.props;
---

<div class="code-grid">
  <div class="code-panel">
    <div class="code-panel-header">
      <span class="code-panel-file">{leftFile}</span>
      <span class="code-panel-tag">{leftTag}</span>
    </div>
    <div class="code-panel-body">
      <pre><span class="sy-p">version:</span> <span class="sy-s">"0.1.0"</span>
<span class="sy-p">name:</span> <span class="sy-s">user-api</span>

<span class="sy-p">components:</span>
  - <span class="sy-p">id:</span> <span class="sy-s">http.server.api</span>
    <span class="sy-p">kind:</span> <span class="sy-s">http.server</span>
    <span class="sy-p">spec:</span>
      <span class="sy-p">framework:</span> <span class="sy-s">hono</span>
      <span class="sy-p">port:</span> <span class="sy-n">3000</span>
      <span class="sy-p">middleware:</span>
        - <span class="sy-s">middleware.authn</span> <span class="sy-c"># Always enforced</span>
        - <span class="sy-s">middleware.authz</span>

  - <span class="sy-p">id:</span> <span class="sy-s">usecase.create-user</span>
    <span class="sy-p">kind:</span> <span class="sy-s">usecase</span>
    <span class="sy-p">spec:</span>
      <span class="sy-p">binds_to:</span> <span class="sy-s">http.server.api:POST:/users</span>
      <span class="sy-p">middleware:</span> [] <span class="sy-c"># Explicit public</span>
      <span class="sy-p">goal:</span> <span class="sy-s">Register a new user</span></pre>
    </div>
  </div>

  <div class="code-panel">
    <div class="code-panel-header">
      <span class="code-panel-file">{rightFile}</span>
      <span class="code-panel-tag">{rightTag}</span>
    </div>
    <div class="code-panel-body">
      <pre><span class="sy-c">// Generated by OpenBoundary - DO NOT EDIT</span>
<span class="sy-k">import</span> {'{'} Hono {'}'} <span class="sy-k">from</span> <span class="sy-s">'hono'</span>
<span class="sy-k">import</span> {'{'} authn {'}'} <span class="sy-k">from</span> <span class="sy-s">'./middleware/authn'</span>
<span class="sy-k">import</span> {'{'} authz {'}'} <span class="sy-k">from</span> <span class="sy-s">'./middleware/authz'</span>
<span class="sy-k">import</span> {'{'} createUser {'}'} <span class="sy-k">from</span> <span class="sy-s">'./handlers/users'</span>

<span class="sy-k">const</span> app = <span class="sy-k">new</span> <span class="sy-f">Hono</span>()

<span class="sy-c">// Protected routes (server-level middleware)</span>
app.<span class="sy-f">use</span>(<span class="sy-s">'*'</span>, authn, authz)

<span class="sy-c">// Public: createUser (explicit override)</span>
app.<span class="sy-f">post</span>(<span class="sy-s">'/users'</span>, createUser)

<span class="sy-k">export default</span> app</pre>
    </div>
  </div>
</div>

<style>
  .code-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--ob-border);
    border: 1px solid var(--ob-border);
    border-radius: 6px;
    overflow: hidden;
  }

  .code-panel {
    background: var(--ob-bg-subtle);
  }

  .code-panel-header {
    padding: 12px 16px;
    border-bottom: 1px solid var(--ob-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .code-panel-file {
    font-family: var(--ob-font-mono);
    font-size: 12px;
    color: var(--ob-text-secondary);
  }

  .code-panel-tag {
    font-family: var(--ob-font-mono);
    font-size: 10px;
    color: var(--ob-text-tertiary);
    padding: 2px 6px;
    background: var(--ob-bg-elevated);
    border-radius: 3px;
  }

  .code-panel-body {
    padding: 16px;
    font-family: var(--ob-font-mono);
    font-size: 12px;
    line-height: 1.8;
    overflow-x: auto;
  }

  .code-panel-body pre {
    margin: 0;
  }

  /* Syntax highlighting - using CSS variables for theme consistency */
  .sy-k { color: var(--sy-keyword, #f9a8d4); }      /* keywords - soft pink */
  .sy-s { color: var(--sy-string, #5eead4); }       /* strings - teal accent */
  .sy-n { color: var(--sy-number, #c4b5fd); }       /* numbers - lavender */
  .sy-c { color: var(--sy-comment, #4a4a4a); }      /* comments - muted */
  .sy-p { color: var(--sy-punctuation, #737373); }  /* punctuation */
  .sy-f { color: var(--sy-function, #5eead4); }     /* functions - teal accent */

  @media (max-width: 900px) {
    .code-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 640px) {
    .code-panel-body {
      font-size: 11px;
      padding: 12px;
    }

    .code-panel-header {
      padding: 10px 12px;
    }

    .code-panel-file {
      font-size: 11px;
    }
  }
</style>
