---
name: ob-compile
description: Compile OpenBoundary specification to generate TypeScript code
model: inherit
---

# Compile OpenBoundary Specification

Compile the specification file to generate type-safe TypeScript code.

## Prerequisites Check

Before compiling, verify the OpenBoundary CLI is available:

```bash
command -v openboundary >/dev/null 2>&1 || command -v bound >/dev/null 2>&1
```

If neither command is found, provide installation instructions:

```text
OpenBoundary CLI not found. Install using one of:

# Option 1: Install script
curl -fsSL https://openboundary.org/install.sh | sh

# Option 2: Go install
go install github.com/openboundary/openboundary/cmd/bound@latest

# Option 3: Build from source
git clone https://github.com/openboundary/openboundary.git
cd openboundary && go build -o bound ./cmd/bound
```

## Steps

### Step 1: Find the Specification File

Look for the spec file in order:
1. Path provided by user
2. `spec.yaml` in project root
3. `openboundary.yaml` in project root

```bash
test -f spec.yaml || test -f openboundary.yaml
```

### Step 2: Validate Before Compiling

Run validation first to catch errors early:

```bash
openboundary validate spec.yaml
# or
bound validate spec.yaml
```

### Step 3: Run the Compiler

```bash
openboundary compile spec.yaml
# or
bound compile spec.yaml
```

With options:
```bash
# Custom output directory
openboundary compile spec.yaml -o ./src/generated

# Force overwrite
openboundary compile spec.yaml --force

# Dry run (show what would be generated)
openboundary compile spec.yaml --dry-run
```

### Step 4: Verify Output

Check that expected files were generated:

```bash
ls -la generated/ 2>/dev/null || ls -la src/generated/
```

Key files to expect:
- `src/server.ts` or `src/components/servers/*.ts`
- `src/middleware/*.ts` (if middleware defined)
- `src/components/usecases/*.ts` (one per usecase)

### Step 5: Report Results

**On success:**

```text
Compilation successful.

Generated files:
  - src/components/servers/http-server-api.ts
  - src/middleware/authn.ts
  - src/components/usecases/create-user.ts
  - src/components/usecases/get-user.ts

Next steps:
1. Implement usecase bodies (look for // TODO: Implement usecase)
2. Run: npm install && npm run dev
3. Test your API at http://localhost:3000

Remember: Only edit usecase function bodies. Other files are regenerated on compile.
```

**On failure:**

```text
Compilation failed.

Error: {error message}

To fix:
1. Check spec.yaml for syntax errors
2. Verify openapi.yaml is valid
3. Ensure all referenced files exist

Run validation for details:
  openboundary validate spec.yaml --strict
```

## Error Handling

### Common Errors

| Error | Cause | Fix |
|-------|-------|-----|
| "spec not found" | Missing spec.yaml | Create with `openboundary init` |
| "invalid yaml" | Syntax error | Check YAML indentation |
| "unknown component" | Bad component reference | Check component IDs match |
| "missing middleware" | Referenced middleware doesn't exist | Define the middleware first |

### If CLI Not in PATH

Try running with full path or npx:

```bash
# If installed via go
~/go/bin/bound compile spec.yaml

# If built locally
./bin/bound compile spec.yaml

# If in node_modules (future npm package)
npx openboundary compile spec.yaml
```

## After Compilation

1. **Generated files are protected** - marked with `// Generated by OpenBoundary - DO NOT EDIT`
2. **Usecase bodies are editable** - implement your business logic there
3. **Config files unchanged** - auth, schema, and spec files remain yours to edit
4. **Recompile anytime** - safe to run repeatedly; only regenerates infrastructure
